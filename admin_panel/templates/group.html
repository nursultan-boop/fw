{% extends 'layout.html' %}

{% block content %}
<h2>Group: {{ group_name }}</h2>

<h3>Rules</h3>
<ul>
    {% for rule in group.rules %}

    <li>{{ rule }} 
        <form action="{{ url_for('remove_rule', group_name=group_name, rule=rule) }}" method="post" style="display:inline;">
            <button type="submit">Remove</button>
        </form>
    </li>
    {% endfor %}
</ul>
<form action="{{ url_for('add_rule', group_name=group_name) }}" method="post">
    <input type="text" name="rule" placeholder="New rule" required>
    <button type="submit">Add Rule</button>
</form>

    <li>
        {{ rule }}
        <button onclick="removeRule('{{ rule }}')">Remove</button>
        <button onclick="editRule('{{ rule }}')">Edit</button>
    </li>
    {% endfor %}
</ul>
<button onclick="addRule()">Add Rule</button>
>>>>>>> parent of 78ec312 (lets' gooo)

<h3>Devices in this Group</h3>
<ul>

    {% for device in group.devices %}
    <li>{{ device }}
        <form action="{{ url_for('remove_device', group_name=group_name, device_ip=device) }}" method="post" style="display:inline;">
            <button type="submit">Remove</button>
        </form>
    </li>
    {% endfor %}
</ul>
<form action="{{ url_for('add_device', group_name=group_name) }}" method="post">
    <select name="device_ip">
        {% for device in devices %}
        <option value="{{ device.ip }}">{{ device.ip }} ({{ device.name }})</option>
        {% endfor %}
    </select>
    <button type="submit">Add Device</button>
</form>

    {% for device in devices %}
    <li>
        <strong>Name:</strong> {{ device.name }}<br>
        <strong>IP:</strong> {{ device.ip }}<br>
        {% if device.ip in group.devices %}
        <button onclick="removeDevice('{{ device.ip }}')">Remove from Group</button>
        {% else %}
        <button onclick="addDevice('{{ device.ip }}')">Add to Group</button>
        {% endif %}
    </li>
    {% endfor %}
</ul>

<script>
function removeRule(rule) {
    if (confirm('Are you sure you want to remove this rule?')) {
        fetch(`/remove_rule/${group_name}/${rule}`, {method: 'POST'})
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('Error removing rule');
                }
            });
    }
}

function editRule(rule) {
    // Implement rule editing logic here
}

function addRule() {
    // Implement rule adding logic here
}

function removeDevice(ip) {
    if (confirm('Are you sure you want to remove this device from the group?')) {
        fetch(`/remove_device/${group_name}/${ip}`, {method: 'POST'})
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('Error removing device');
                }
            });
    }
}

function addDevice(ip) {
    if (confirm('Are you sure you want to add this device to the group?')) {
        fetch(`/add_device/${group_name}/${ip}`, {method: 'POST'})
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    location.reload();
                } else {
                    alert('Error adding device');
                }
            });
    }
}
console.log("hello")
</script>

{% endblock %}
