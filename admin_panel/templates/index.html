{% extends 'layout.html' %}

{% block content %}
<h2>Connected Devices</h2>
<ul>
    {% for device in devices %}
    <li>
        <strong>Name:</strong> {{ device.name }}<br>
        <strong>IP:</strong> {{ device.ip }}
        <!-- Optionally add a form or link to remove the device, if required -->
    </li>
    {% endfor %}
</ul>

<h2 id="groups">Groups</h2>
<ul>
    {% for group_name in groups %}
    <li><a href="{{ url_for('group_page', group_name=group_name) }}">{{ group_name }}</a></li>
    {% endfor %}
</ul>
<button onclick="location.href='{{ url_for('add_group') }}'">Add New Group</button>

<h2 id="modules">Modules</h2>
<ul>
    {% for module in ['example_module'] %}
    <li>
        {{ module }}
        <button onclick="location.href='{{ url_for('module_page', module_name=module) }}'">Manage</button>
        <button onclick="toggleModule('{{ module }}')">Toggle On/Off</button>
    </li>
    {% endfor %}
</ul>

<script>
function toggleModule(module) {
    if (confirm('Are you sure you want to toggle this module?')) {
        fetch(`/toggle_module/${module}`, {method: 'POST'})
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Module toggled successfully');
                } else {
                    alert('Error toggling module');
                }
            });
    }
}
</script>
{% endblock %}
